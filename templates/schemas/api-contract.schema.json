{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "API Contract Schema",
  "description": "API contract specification for backend tasks defining the interface between services",
  "type": "object",
  "properties": {
    "endpoint": {
      "type": "string",
      "description": "API endpoint path (e.g., '/api/v1/users')"
    },
    "method": {
      "type": "string",
      "enum": [
        "GET",
        "POST",
        "PUT",
        "PATCH",
        "DELETE"
      ],
      "description": "HTTP method"
    },
    "request_schema": {
      "type": "object",
      "description": "JSON schema or description of request body"
    },
    "response_schema": {
      "type": "object",
      "description": "JSON schema of successful response - must contain a 'data' key with object or array payload",
      "required": [
        "data"
      ],
      "properties": {
        "data": {
          "description": "Response payload - can be an object or array of objects",
          "oneOf": [
            {
              "type": "object",
              "description": "Single object response"
            },
            {
              "type": "array",
              "description": "Array of objects response"
            }
          ]
        }
      }
    },
    "error_responses": {
      "type": "object",
      "description": "Error response structure following RFC 7807 Problem Details for HTTP APIs",
      "required": [
        "status",
        "title"
      ],
      "properties": {
        "type": {
          "type": "string",
          "format": "uri",
          "description": "A URI reference that identifies the problem type (e.g., 'https://example.com/errors/validation-error')"
        },
        "title": {
          "type": "string",
          "description": "A short, human-readable summary of the problem type"
        },
        "status": {
          "type": "integer",
          "minimum": 100,
          "maximum": 599,
          "description": "The HTTP status code generated by the server"
        },
        "detail": {
          "type": "string",
          "description": "A human-readable explanation specific to this occurrence of the problem"
        },
        "instance": {
          "type": "string",
          "format": "uri",
          "description": "A URI reference that identifies the specific occurrence of the problem"
        },
        "validationErrors": {
          "type": "array",
          "description": "Array of validation errors (for 422 validation failures)",
          "items": {
            "type": "object",
            "required": [
              "field",
              "message"
            ],
            "properties": {
              "field": {
                "type": "string",
                "description": "JSON path to the invalid field (e.g., 'body.email' or 'query.page')"
              },
              "message": {
                "type": "string",
                "description": "Human-readable error message for this field"
              },
              "code": {
                "type": "string",
                "description": "Machine-readable error code (e.g., INVALID_FORMAT, MIN_VALUE)"
              }
            }
          }
        }
      }
    },
    "authentication": {
      "type": "object",
      "description": "Authentication requirements for this endpoint",
      "properties": {
        "required": {
          "type": "boolean",
          "description": "Whether authentication is required"
        },
        "type": {
          "type": "string",
          "enum": [
            "Bearer",
            "Basic",
            "ApiKey",
            "OAuth2",
            "OpenID",
            "None"
          ],
          "description": "Authentication scheme type"
        },
        "scheme": {
          "type": "string",
          "description": "Authentication scheme name (e.g., 'Bearer', 'Basic')"
        },
        "bearerFormat": {
          "type": "string",
          "description": "Format of bearer token (e.g., 'JWT')"
        },
        "location": {
          "type": "string",
          "enum": [
            "header",
            "query",
            "cookie"
          ],
          "description": "Where to send the credentials"
        },
        "parameterName": {
          "type": "string",
          "description": "Name of the header, query parameter, or cookie (e.g., 'Authorization', 'api_key')"
        },
        "description": {
          "type": "string",
          "description": "Additional authentication details and requirements"
        },
        "scopes": {
          "type": "array",
          "description": "Required OAuth2/OpenID scopes",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}